{
  "tasks": [
    {
      "id": "enhance_001",
      "title": "Replace Keyword Era Detection with AI-Powered Analysis",
      "description": "The challenge_service.go `detectEraFromResponse()` function (line ~110) uses primitive keyword string matching to detect eras from user text. This must be replaced with a real AI-powered analysis.\n\n**File:** `backend/internal/services/challenge_service.go`\n\n**Current Problem:** The function checks if input contains words like 'butterfly', 'paris', 'tumblr' etc. using `strings.Contains()`. This fails for nuanced responses like 'I love vintage vibes with modern twists' that don't contain exact keywords.\n\n**Implementation:**\n1. Add an `AIAnalyzer` struct with `AnalyzeEraFromText(input string) (string, error)` method\n2. Call GLM-5 API at `https://api.z.ai/api/paas/v4/chat/completions` with model `glm-5`\n3. System prompt: 'You are an aesthetic era classifier. Given user text, classify into exactly one of: y2k, 2016_tumblr, 2018_vsco, 2020_cottagecore, dark_academia, indie_sleaze, 2022_clean_girl, 2024_mob_wife, coastal_cowgirl, 2025_demure. Respond with ONLY the era key.'\n4. Parse response, validate against known era keys, fallback to keyword detection if API fails\n5. Add `AI_API_URL` and `AI_API_KEY` env vars to config.go Config struct\n6. Update `ChallengeService` constructor to accept config for API credentials\n7. Add HTTP client with 10s timeout for API calls\n8. Keep existing keyword detection as fallback when API is unavailable\n\n**Update config.go:**\n```go\nAIAPIURL string `envconfig:\"AI_API_URL\" default:\"https://api.z.ai/api/paas/v4/chat/completions\"`\nAIAPIKey string `envconfig:\"AI_API_KEY\"`\n```\n\n**Update main.go:** Pass config to NewChallengeService(db, cfg)\n\n**Test:** `cd backend \u0026\u0026 go build ./...`",
      "status": "completed",
      "priority": 10,
      "depends_on": [],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-15T01:58:30Z"
    },
    {
      "id": "enhance_002",
      "title": "Expand Quiz Question Pool and Add Weighted Scoring Algorithm",
      "description": "The quiz system has only 3 hardcoded questions in `era_seed.go` (SeedQuestions array, line ~138-184). With only 3 questions, results feel shallow and repetitive. The scoring in `era_service.go` `SubmitQuizAnswers()` is a simple vote count with no weighting.\n\n**File 1:** `backend/internal/services/era_seed.go`\n- Expand SeedQuestions from 3 to 15 questions covering these categories:\n  - Style (3 questions): outfit, accessories, hair\n  - Music (2 questions): genre preference, concert vibe\n  - Social (2 questions): weekend plans, social media\n  - Aesthetic (3 questions): room decor, color palette, photography style\n  - Lifestyle (2 questions): food/drink, travel destination\n  - Culture (3 questions): movies/shows, icons/role models, slang\n- Each question must have exactly 10 options mapping to all 10 eras\n- Options must feel natural, not forced (e.g., 'Iced matcha with oat milk' maps to 2022_clean_girl)\n\n**File 2:** `backend/internal/services/era_service.go`\n- Update `SubmitQuizAnswers()` to use weighted scoring:\n  - Category weights: Style=1.5, Music=1.2, Social=1.0, Aesthetic=1.3, Lifestyle=0.8, Culture=1.0\n  - Store question category in EraQuiz model (already has Category field)\n  - Normalize final scores to percentages (0-100)\n  - Return top 3 eras with scores, not just the winner\n- Update `SeedQuizQuestions()` to set category field on each question\n- Ensure idempotent seeding: check by question text hash, not just count\n\n**File 3:** `backend/internal/models/era_quiz.go` - Category field already exists, ensure it's populated\n\n**Test:** `cd backend \u0026\u0026 go build ./...`",
      "status": "completed",
      "priority": 10,
      "depends_on": [],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-15T02:07:09Z"
    },
    {
      "id": "enhance_003",
      "title": "Strengthen Content Moderation with Real Profanity Filter",
      "description": "The moderation_service.go `FilterContent()` (line ~23) only checks for 'spam' and 'scam' using basic regex. This is inadequate for App Store review â€” Apple Guideline 1.2 requires robust content filtering.\n\n**File:** `backend/internal/services/moderation_service.go`\n\n**Current Problem:** Only 2 regex patterns: `\\b(spam|scam)\\b`. Challenge responses with profanity, slurs, or harmful content pass through unfiltered.\n\n**Implementation:**\n1. Create a comprehensive banned words list (100+ terms) covering:\n   - Profanity and slurs (common English offensive terms)\n   - Hate speech keywords\n   - Sexual content terms\n   - Violence-related terms\n   - Spam patterns (URLs, phone numbers, repeated chars)\n2. Add regex patterns for:\n   - URL detection: `https?://\\S+` or `www\\.\\S+`\n   - Email detection: `\\S+@\\S+\\.\\S+`\n   - Phone numbers: `\\d{3}[-.]?\\d{3}[-.]?\\d{4}`\n   - Repeated characters (4+): `(.)\\1{3,}`\n   - ALL CAPS text (5+ consecutive): `[A-Z]{5,}`\n3. Add a `SanitizeAndCheck(text string) (isClean bool, sanitized string, reason string)` method\n4. Integrate into `challenge_service.go` `SubmitChallengeResponse()` â€” call FilterContent on user response before processing\n5. Store the banned words as a `var bannedPatterns []string` slice compiled into `[]*regexp.Regexp` at init time for performance\n6. Return specific rejection reasons: 'inappropriate_language', 'spam_detected', 'url_not_allowed'\n\n**Update challenge_service.go:** Add moderation check before saving response:\n```go\nif clean, reason := s.moderationService.FilterContent(response); !clean {\n    return nil, fmt.Errorf(\"content rejected: %s\", reason)\n}\n```\n\n**Update main.go:** Pass moderationService to NewChallengeService\n\n**Test:** `cd backend \u0026\u0026 go build ./...`",
      "status": "completed",
      "priority": 9,
      "depends_on": [],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-15T02:16:39Z"
    },
    {
      "id": "enhance_004",
      "title": "Fix Delete Account Password Flow and Apple Token Verification",
      "description": "Two critical auth issues: (1) Settings screen has no password input modal for delete account â€” it calls the API without password for authenticated users. (2) Apple Sign-In token is decoded but signature is NOT verified against Apple's JWKS.\n\n**File 1:** `mobile/app/(protected)/(tabs)/settings.tsx`\n- Add a password confirmation modal before account deletion for non-Apple users:\n  - Import Modal from `../../components/ui/Modal`\n  - Add state: `showDeleteModal`, `deletePassword`, `deleteLoading`, `deleteError`\n  - Modal content: warning icon (Ionicons 'warning'), red header text 'Delete Account', description 'This action cannot be undone. All your data will be permanently deleted.', password Input with showPasswordToggle, error text display, two buttons: Cancel (outline) and Delete (destructive variant with isLoading)\n  - On confirm: call `deleteAccount(deletePassword)` from AuthContext\n  - On success: `hapticSuccess()`, router.replace('/(auth)/login')\n  - On error: `hapticError()`, show error message in modal\n- For Apple Sign-In users (no password): show confirmation dialog with just 'Are you sure?' text, no password field\n- Add `isAppleUser` flag to AuthContext User type and check it\n\n**File 2:** `backend/internal/services/auth_service.go`\n- The `AppleSignIn()` method (line ~146) decodes the identity token JWT payload with base64 but does NOT verify the signature against Apple's JWKS endpoint (`https://appleid.apple.com/auth/keys`)\n- Add Apple JWKS verification:\n  1. Fetch Apple's public keys from `https://appleid.apple.com/auth/keys` (cache for 24h)\n  2. Parse JWT header to get `kid` (key ID)\n  3. Find matching public key from JWKS\n  4. Verify RS256 signature using `crypto/rsa` and `crypto/x509`\n  5. Verify claims: `iss` == 'https://appleid.apple.com', `aud` == app bundle ID, `exp` \u003e now\n- Add `AppleBundleID` to config.go: `envconfig:\"APPLE_BUNDLE_ID\"`\n\n**Test:** `cd backend \u0026\u0026 go build ./...`",
      "status": "completed",
      "priority": 9,
      "depends_on": [],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-15T02:28:51Z"
    },
    {
      "id": "enhance_005",
      "title": "Fix Hardcoded URLs and Add Real Legal Page Links in Settings",
      "description": "Settings screen has placeholder URLs for Privacy Policy and Terms of Service pointing to `example.com`. These must use the actual backend endpoints.\n\n**File:** `mobile/app/(protected)/(tabs)/settings.tsx`\n\n**Current Problem:** Lines containing privacy/terms links use hardcoded placeholder URLs like `Linking.openURL('https://example.com/privacy')` and `Linking.openURL('https://example.com/terms')`. These will cause App Store rejection.\n\n**Implementation:**\n1. Import `Linking` from 'react-native' (may already be imported)\n2. Get API base URL from the api client: `import { api } from '../../../../lib/api'`\n3. Replace privacy URL with: `${API_BASE_URL}/legal/privacy` where API_BASE_URL comes from `process.env.EXPO_PUBLIC_API_URL || 'http://localhost:8080/api'`\n4. Replace terms URL with: `${API_BASE_URL}/legal/terms`\n5. Add a WebView-based in-app browser modal instead of external Linking:\n   - Use react-native Modal + a ScrollView that fetches HTML from the API\n   - Add state: `showLegalModal`, `legalContent`, `legalTitle`, `legalLoading`\n   - On press: fetch content from API endpoint using axios, display in ScrollView with white bg\n   - Add close button (X) at top right\n   - Fallback: if fetch fails, open in external browser via Linking\n6. Also verify the backend legal_handler.go returns proper HTML â€” currently it does (privacy and terms endpoints return full HTML pages)\n\n**Additional:** Check that `app.json` or `app.config.ts` has the correct privacy policy URL set for App Store metadata â€” it should point to `http://89.47.113.196:8086/api/legal/privacy`\n\n**Test:** `cd mobile \u0026\u0026 npx tsc --noEmit`",
      "status": "completed",
      "priority": 8,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-15T02:37:26Z"
    },
    {
      "id": "enhance_006",
      "title": "Implement Loading Skeletons and Error States on All Screens",
      "description": "Multiple screens use plain ActivityIndicator for loading and have no error states with retry buttons. This doesn't meet App Store quality standards for 2025-2026.\n\n**Files to modify:**\n\n1. `mobile/app/(protected)/(tabs)/index.tsx` (Quiz Home)\n   - Replace ActivityIndicator loading with skeleton layout: 3 rounded-2xl placeholder boxes (bg-gray-800 with opacity pulse animation) matching the streak badge, result card, and start button layout\n   - Add error state: centered View with Ionicons 'cloud-offline' (64px, gray-500), 'Something went wrong' text-xl, 'Tap to retry' text-sm gray-400, Button with onPress={fetchData} variant='outline'\n   - Wrap fetch in try/catch, add `error` state variable\n\n2. `mobile/app/(protected)/(tabs)/history.tsx`\n   - Add error state with retry for FlatList data fetch failure\n   - Add RefreshControl error feedback: if refresh fails, show toast-style error banner at top (red-900/50 bg, text-red-400) that auto-dismisses after 3s\n\n3. `mobile/app/(protected)/(tabs)/challenge.tsx`\n   - Add loading skeleton for challenge card (pulsing rounded rect)\n   - Add error state if daily challenge fetch fails\n   - Add submission error handling with inline error message below submit button\n\n4. `mobile/app/(protected)/quiz.tsx`\n   - Add loading state when fetching questions from API\n   - Add error state if questions fail to load: 'Could not load quiz' with retry button\n   - Add submission loading state: full-screen overlay with ActivityIndicator + 'Analyzing your aesthetic...' text\n\n5. `mobile/app/(protected)/results/[id].tsx`\n   - Add 404 error state: 'Result not found' with Ionicons 'search' icon and 'Go Back' button\n   - Add loading skeleton matching result card layout\n\n**Skeleton Component Pattern (reuse across screens):**\n```tsx\nconst Skeleton = ({ className }: { className?: string }) =\u003e (\n  \u003cAnimated.View className={cn('bg-gray-800 rounded-2xl', className)} \n    style={{ opacity: useSharedValue(0.3-0.7 pulse) }} /\u003e\n);\n```\nUse `react-native-reanimated` withRepeat + withTiming for pulse animation.\n\n**Test:** `cd mobile \u0026\u0026 npx tsc --noEmit`",
      "status": "completed",
      "priority": 8,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-15T02:48:14Z"
    },
    {
      "id": "enhance_007",
      "title": "Add Haptic Feedback to All Missing Interactions",
      "description": "While most buttons have haptics, several interactions are missing haptic feedback per Apple Guideline 4.2 and the 2025-2026 Haptic-Visual Sync trend.\n\n**Files to modify:**\n\n1. `mobile/app/(protected)/(tabs)/challenge.tsx`\n   - Add `hapticSuccess()` after successful challenge submission (currently no haptic on submit success)\n   - Add `hapticError()` on submission failure\n   - Add `hapticSuccess()` when a new badge is unlocked (compare badges before/after streak update)\n   - Add `hapticMedium()` when daily challenge loads for the first time (engagement cue)\n\n2. `mobile/app/(protected)/(tabs)/history.tsx`\n   - Add `hapticLight()` on result item press (navigating to detail)\n   - Add `hapticError()` on pull-to-refresh failure\n\n3. `mobile/app/(protected)/results/[id].tsx`\n   - Add `hapticSuccess()` when share completes successfully\n   - Add `hapticError()` when share or result load fails\n   - Add `hapticMedium()` on 'Retake Quiz' button press (stronger feedback for major action)\n\n4. `mobile/app/(protected)/quiz.tsx`\n   - Add `hapticSuccess()` on final question answer (quiz complete moment)\n   - Add `hapticMedium()` on 'Get Results' button press\n   - Add `hapticWarning()` on quiz exit/back confirmation\n\n5. `mobile/app/(protected)/paywall.tsx`\n   - Add `hapticSuccess()` after successful purchase\n   - Add `hapticError()` on purchase failure\n   - Add `hapticLight()` on package selection\n\n6. `mobile/app/onboarding.tsx`\n   - Add `hapticLight()` on page scroll snap (when page index changes)\n   - Add `hapticMedium()` on 'Try Free' CTA button\n\n**Import pattern:** `import { hapticSuccess, hapticError, hapticLight, hapticMedium, hapticWarning } from '../../lib/haptics';` (adjust path depth per file)\n\n**Test:** `cd mobile \u0026\u0026 npx tsc --noEmit`",
      "status": "completed",
      "priority": 7,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-15T02:54:58Z"
    },
    {
      "id": "enhance_008",
      "title": "Implement Share Prompt After Every Quiz Result",
      "description": "After completing a quiz, the results screen has a share button but there's no proactive share prompt. Per engagement best practices and the Viral Share Sheets trend, users should be prompted to share their result immediately.\n\n**File 1:** `mobile/app/(protected)/results/[id].tsx`\n- Add auto-show share prompt 2 seconds after result loads:\n  - State: `showSharePrompt` (boolean, default false)\n  - useEffect: `setTimeout(() =\u003e setShowSharePrompt(true), 2000)` on mount\n  - Share prompt UI: a bottom-anchored card (absolute bottom-6 left-4 right-4) with:\n    - LinearGradient background (pink #ec4899 to purple #a855f7)\n    - Row layout: Ionicons 'share-social' (24px white), 'Share your era with friends!' text-white font-semibold, 'Share' Button (white bg, pink text, small)\n    - Dismiss X button (top-right corner of card)\n    - `hapticLight()` when prompt appears\n  - On share press: call existing share function, dismiss prompt\n  - On dismiss: set `showSharePrompt(false)`, save dismissal to AsyncStorage so it only shows once per session\n\n**File 2:** `mobile/components/ui/ShareableResult.tsx`\n- The ShareableResult component already generates a 1080x1920 shareable image card\n- Ensure the share sheet includes:\n  - Image from view-shot capture\n  - Message: 'I got {eraTitle}! Find your aesthetic era on EraCheck âœ¨'\n  - URL placeholder for app store link (use `https://eracheck.app` as placeholder)\n- Add share count display after sharing: 'Shared {n} times' badge on the result card\n\n**File 3:** `mobile/app/(protected)/(tabs)/index.tsx` (Quiz Home)\n- After quiz completion redirect, show a brief celebration animation:\n  - Confetti-style effect using Reanimated (3-4 colored circles animating upward with fade)\n  - Duration: 1.5s, auto-dismiss\n  - `hapticSuccess()` on celebration start\n\n**Test:** `cd mobile \u0026\u0026 npx tsc --noEmit`",
      "status": "completed",
      "priority": 7,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-15T03:03:40Z"
    },
    {
      "id": "enhance_009",
      "title": "Enhance Quiz Screen with Animations and Progress Feedback",
      "description": "The quiz screen (`quiz.tsx`) auto-advances after 300ms delay but lacks visual polish. Needs smooth transitions, better progress indication, and engaging micro-interactions per 2025-2026 trends.\n\n**File:** `mobile/app/(protected)/quiz.tsx`\n\n**Enhancements:**\n\n1. **Animated Question Transitions:**\n   - Use `react-native-reanimated` FadeInRight/FadeOutLeft for question text\n   - Each new question slides in from right (300ms), previous slides out left\n   - Add `useSharedValue` for translateX animation: entering = translateX(50â†’0) + opacity(0â†’1), exiting = translateX(0â†’-50) + opacity(1â†’0)\n\n2. **Progress Bar Animation:**\n   - Current progress bar jumps. Use `withTiming` to animate width smoothly (400ms, easing: Easing.bezier(0.25, 0.1, 0.25, 1))\n   - Add percentage text next to bar: '{Math.round((current/total)*100)}%' in text-xs text-gray-400\n   - Progress bar should use LinearGradient (pink #ec4899 â†’ purple #a855f7) instead of solid color\n\n3. **Option Selection Feedback:**\n   - On select: scale animation 1.0 â†’ 0.95 â†’ 1.02 â†’ 1.0 (spring effect, 200ms)\n   - Selected option gets animated checkmark (Ionicons 'checkmark-circle') that scales from 0â†’1\n   - Unselected options dim slightly (opacity 0.6) when one is selected\n   - Add `hapticSelection()` (already present, verify it fires)\n\n4. **Question Counter Enhancement:**\n   - Change from 'Q 3 / 15' to a step indicator: row of small dots (4px each)\n   - Current dot is pink and larger (8px), completed dots are pink, upcoming are gray-700\n   - Only show 7 dots at a time (sliding window around current)\n\n5. **Submit State:**\n   - 'Get Results' button: pulsing glow animation when enabled (shadow-pink-500/50 with opacity cycling)\n   - On submit: button transforms to loading spinner with 'Discovering your era...' text\n   - Full-screen overlay with semi-transparent bg-black/60 during API call\n\n**Test:** `cd mobile \u0026\u0026 npx tsc --noEmit`",
      "status": "completed",
      "priority": 7,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-15T03:09:36Z"
    },
    {
      "id": "enhance_010",
      "title": "Enhance Results Screen with Animated Score Breakdown",
      "description": "The results screen (`results/[id].tsx`) shows era scores as static bars. Need animated reveal, richer visualization, and better visual hierarchy.\n\n**File:** `mobile/app/(protected)/results/[id].tsx`\n\n**Enhancements:**\n\n1. **Animated Score Bars:**\n   - Import `useSharedValue`, `withTiming`, `withDelay` from react-native-reanimated\n   - Each score bar animates from width 0 to final width with staggered delays (index * 150ms)\n   - Duration: 800ms per bar, easing: Easing.out(Easing.cubic)\n   - Score percentage text counts up from 0 to final value (useAnimatedText or interpolate)\n   - Minimum 3 scores shown, max 5 (hide scores below 5%)\n\n2. **Era Result Card Enhancement:**\n   - Large emoji: animate scale from 0â†’1.2â†’1.0 (spring bounce) on mount\n   - Era title: fade in + slide up (translateY 20â†’0, opacity 0â†’1, 500ms delay)\n   - Add era color as LinearGradient behind the emoji (colors from era profile + transparent)\n   - Share count badge: pill shape with Ionicons 'share' + count, positioned below emoji\n\n3. **Trait Sections (Music Taste, Style Traits):**\n   - Wrap each in GlassCard component (already available) with glass variant\n   - Add section icons: 'musical-notes' for Music, 'shirt' for Style\n   - Stagger section appearance with 200ms delays\n\n4. **Action Buttons Section:**\n   - 'Share Your Era' â€” gradient button (pinkâ†’purple) with Ionicons 'share-social', full width\n   - 'Retake Quiz' â€” outline button with Ionicons 'refresh', full width, mt-3\n   - 'View History' â€” text button (no bg) with Ionicons 'time', centered\n   - Add divider line (bg-gray-800 h-px) between result content and action buttons\n\n5. **Comparison Feature:**\n   - Below score breakdown, add 'How you compare' section\n   - Show a horizontal bar chart with average scores across all users (call GET /api/era/stats)\n   - Label: 'Your top era is chosen by X% of users'\n   - This requires a new backend endpoint or using existing stats data\n\n**Test:** `cd mobile \u0026\u0026 npx tsc --noEmit`",
      "status": "completed",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-15T03:18:21Z"
    },
    {
      "id": "enhance_011",
      "title": "Enhance Daily Challenge Screen with Timer and Streaks UI",
      "description": "The daily challenge screen needs better engagement mechanics: countdown timer to next challenge, streak milestone celebrations, and improved badge display.\n\n**File:** `mobile/app/(protected)/(tabs)/challenge.tsx`\n\n**Enhancements:**\n\n1. **Next Challenge Countdown Timer:**\n   - After submitting today's challenge, show countdown to midnight (next challenge available)\n   - Calculate: `const now = new Date(); const midnight = new Date(now); midnight.setHours(24,0,0,0); const remaining = midnight - now;`\n   - Display as 'Next challenge in HH:MM:SS' with Ionicons 'timer' icon\n   - Use `setInterval` (1s) to update, clean up on unmount\n   - Style: bg-gray-900 border border-gray-800 rounded-2xl p-4, centered text\n   - Timer digits in text-2xl font-bold text-pink-400 (monospace if available)\n\n2. **Streak Milestone Celebrations:**\n   - When streak reaches a milestone (3, 7, 14, 21, 30, 50), show celebration overlay:\n   - Full-screen semi-transparent overlay (bg-black/70)\n   - Large badge emoji (from StreakBadge milestone config) at 80px\n   - 'Achievement Unlocked!' text-2xl font-bold text-white\n   - Badge name + description from backend badges data\n   - LinearGradient border effect (pinkâ†’purpleâ†’pink animated)\n   - 'Continue' button to dismiss\n   - `hapticSuccess()` on milestone hit\n   - Store last celebrated milestone in AsyncStorage to prevent repeat showing\n\n3. **Improved Badge Display:**\n   - Current badges are horizontal scroll with locked at 0.35 opacity\n   - Change to 2-column grid layout (3 rows)\n   - Locked badges: grayscale + lock icon overlay (Ionicons 'lock-closed')\n   - Unlocked badges: full color + subtle glow (shadow with badge color)\n   - Progress text under each: 'X/Y days' showing progress toward unlock\n   - Next badge to unlock highlighted with pulsing border\n\n4. **Challenge History Enhancement:**\n   - Show era color dot next to each history item\n   - Add detected era title (not just the key) from era profiles\n   - Truncate long responses with '...' and expand on press\n\n5. **Character Counter on Input:**\n   - The TextInput allows 500 chars but doesn't show remaining count\n   - Add character counter below input: '{length}/500' in text-xs\n   - Color: text-gray-500 normally, text-orange-400 at 80%+, text-red-400 at 95%+\n\n**Test:** `cd mobile \u0026\u0026 npx tsc --noEmit`",
      "status": "in_progress",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-15T03:18:21Z"
    },
    {
      "id": "enhance_012",
      "title": "Polish Quiz Home Screen with Engagement Widgets",
      "description": "The home screen (protected tabs index.tsx) needs richer engagement elements: streak animation, era of the day, trending era stats, and improved visual hierarchy.\n\n**File:** `mobile/app/(protected)/(tabs)/index.tsx`\n\n**Enhancements:**\n\n1. **Welcome Header with User Greeting:**\n   - Top section: 'Hey there! âœ¨' (or user email name part if logged in) in text-2xl font-bold\n   - Subtitle: 'Ready to discover your era?' in text-base text-gray-400\n   - If guest: show UsageBadge component with remaining quiz count\n\n2. **Streak Widget Enhancement:**\n   - Use StreakBadge component (already imported) with size='lg'\n   - Add animated flame if streak \u003e 0 (Reanimated: scale pulse 1.0â†’1.15â†’1.0, repeat, duration 1500ms)\n   - Below streak: 'Keep your streak alive!' text if streak \u003e 0, or 'Start a streak today!' if 0\n   - If streak is about to break (no quiz today and streak \u003e 0): warning banner bg-orange-900/30 border-orange-700 'Don't lose your {n}-day streak!' with Ionicons 'warning'\n\n3. **Latest Result Card Enhancement:**\n   - If user has a result: show ShareableResult preview (small variant) with era emoji, title, and 'View Details' link\n   - LinearGradient background using era's color palette\n   - If no result: show placeholder card with sparkles icon and 'Take your first quiz!' CTA\n\n4. **Start Quiz CTA Button:**\n   - Make it the hero element: full-width, tall (py-6), LinearGradient (pink #ec4899 â†’ rose #f43f5e)\n   - Large icon: Ionicons 'sparkles' (28px)\n   - Text: 'Discover Your Era' in text-xl font-bold\n   - Subtitle below: '15 questions â€¢ 2 min' in text-sm opacity-80\n   - Animated subtle glow effect (shadow pulsing)\n\n5. **Info Cards as Bento Grid:**\n   - Arrange the 3 info cards (10 Eras, Personalized, Share) in a bento grid:\n   - Row 1: one large card (col-span-2) for '10 Unique Eras'\n   - Row 2: two smaller cards side by side for 'Personalized' and 'Share \u0026 Compare'\n   - Each card uses GlassCard with glass variant\n   - Add Ionicons for each: 'color-palette', 'finger-print', 'people'\n\n6. **Remove unused `guestRemaining` state** that conflicts with `guestUsageCount` from AuthContext\n\n**Test:** `cd mobile \u0026\u0026 npx tsc --noEmit`",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_013",
      "title": "Add Onboarding Polish with Animations and Page Transitions",
      "description": "The onboarding screen (`onboarding.tsx`) uses a basic horizontal ScrollView with static pages. It needs smooth animations, parallax effects, and a more engaging flow per 2025-2026 trends.\n\n**File:** `mobile/app/onboarding.tsx`\n\n**Enhancements:**\n\n1. **Page Transition Animations:**\n   - Track scroll position with `useSharedValue` from Reanimated\n   - Each page content (icon, title, description) should animate based on scroll position:\n     - Icon: scale from 0.5â†’1.0 as page enters, parallax translateY offset\n     - Title: fade in + slide up (translateY 30â†’0)\n     - Description: fade in with 200ms delay after title\n   - Use `useAnimatedStyle` with `interpolate()` based on scroll offset\n\n2. **Page Content Enhancement:**\n   - Page 1 (Welcome): Large sparkles icon (80px), 'Discover Your Era' text-3xl, 'Find out which aesthetic era defines your personality' text-lg text-gray-300, LinearGradient orb behind icon (pink/purple, 150px circle, blurred)\n   - Page 2 (Features): 3 feature pills in vertical stack:\n     - 'ðŸŽ­ 10 Unique Aesthetic Eras' in GlassCard\n     - 'ðŸ“Š Detailed Style Breakdown' in GlassCard\n     - 'ðŸ”¥ Daily Challenges \u0026 Streaks' in GlassCard\n   - Page 3 (CTA): Large emoji collage (grid of era emojis), 'Ready to Begin?' text-3xl, two buttons:\n     - 'Try Free' â€” gradient button (pinkâ†’purple), full width, `hapticMedium()`\n     - 'Sign In' â€” outline button (white border), full width below\n\n3. **Dot Indicator Enhancement:**\n   - Current dot expands width (8pxâ†’24px) with animation when active\n   - Active dot uses LinearGradient fill (pinkâ†’purple)\n   - Inactive dots: bg-gray-700, 8px circles\n   - Animate with `useAnimatedStyle` interpolating width based on scroll\n\n4. **Skip Button:**\n   - Top right: 'Skip' text button (text-gray-400) that jumps to CTA page\n   - Only show on pages 1 and 2\n   - `hapticLight()` on press\n\n5. **Auto-Scroll Hint:**\n   - On page 1, after 3s idle, show subtle left-pointing chevron animation (Ionicons 'chevron-forward') bouncing right to hint at swiping\n   - Dismiss on first scroll\n\n**Test:** `cd mobile \u0026\u0026 npx tsc --noEmit`",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_014",
      "title": "Add Pull-to-Refresh Error Recovery and Offline Banner",
      "description": "Multiple screens have pull-to-refresh but no error recovery or offline detection. Users on poor connections see broken states.\n\n**Files to modify:**\n\n1. **Create `mobile/lib/network.ts`** â€” Network status utility:\n   - Import `NetInfo` from `@react-native-community/netinfo` â€” WAIT, check package.json first. If not available, use a simpler approach:\n   - Create a `useNetworkStatus()` hook that pings the API health endpoint every 30s\n   - Returns `{ isOnline: boolean, isChecking: boolean }`\n   - On offline detection: `hapticWarning()`\n   - Cache last known state in AsyncStorage\n\n2. **Create offline banner component** in screens that need it:\n   - Add to `mobile/app/(protected)/(tabs)/index.tsx`, `history.tsx`, `challenge.tsx`:\n   ```tsx\n   {!isOnline \u0026\u0026 (\n     \u003cView className=\"bg-red-900/50 border border-red-700 rounded-xl mx-4 mt-2 p-3 flex-row items-center gap-2\"\u003e\n       \u003cIonicons name=\"cloud-offline\" size={20} color=\"#f87171\" /\u003e\n       \u003cText className=\"text-red-400 text-sm flex-1\"\u003eYou're offline. Some features may be unavailable.\u003c/Text\u003e\n     \u003c/View\u003e\n   )}\n   ```\n\n3. **Pull-to-Refresh Error Handling:**\n   - `history.tsx`: On refresh failure, show inline error banner (auto-dismiss 3s):\n     ```tsx\n     {refreshError \u0026\u0026 (\n       \u003cAnimated.View entering={FadeIn} exiting={FadeOut}\n         className=\"bg-red-900/30 border border-red-800 rounded-xl mx-4 p-3 mb-2\"\u003e\n         \u003cText className=\"text-red-400 text-sm text-center\"\u003eFailed to refresh. Pull down to try again.\u003c/Text\u003e\n       \u003c/Animated.View\u003e\n     )}\n     ```\n   - Add `refreshError` state, set on catch, auto-clear with `setTimeout(3000)`\n   - Same pattern for `challenge.tsx` and `index.tsx`\n\n4. **Retry Logic:**\n   - On error state screens, add exponential backoff: 1s â†’ 2s â†’ 4s (max 3 retries)\n   - After 3 failures, show persistent error with manual 'Retry' button\n   - Track retry count in state, reset on success\n\n**Test:** `cd mobile \u0026\u0026 npx tsc --noEmit`",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    }
  ]
}